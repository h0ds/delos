# Build stage
FROM node:20-alpine AS builder

WORKDIR /app

COPY package*.json ./
COPY packages/client/package.json packages/client/

RUN npm ci

COPY packages/client packages/client/

RUN npm --workspace=@sigint/client run build

# Production stage - serve with lightweight server
FROM node:20-alpine

WORKDIR /app

RUN npm install -g serve

COPY --from=builder /app/packages/client/dist ./dist

EXPOSE 5173

CMD ["serve", "-s", "dist", "-l", "5173"]
